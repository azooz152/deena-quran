<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>تطبيق دينا للقرآن الكريم</title>
    <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@600;800;900&family=Amiri:wght@700&display=swap" rel="stylesheet">
    
    <style>
        /* --- 1. التصميم العام (CSS مدمج) --- */
        * { box-sizing: border-box; outline: none; user-select: none; }
        
        body {
            margin: 0;
            height: 100vh;
            overflow: hidden;
            font-family: 'Cairo', sans-serif;
            /* خلفية متدرجة زاهية (ستايل ديزني) */
            background: linear-gradient(135deg, #00C6FF 0%, #0072FF 100%);
            display: flex;
            justify-content: center;
            align-items: center;
        }

        /* الطبقة الضبابية للخلفية (لإبراز المحتوى) */
        .glass-overlay {
            position: absolute;
            top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(5px);
            z-index: 1;
        }

        /* صورة دينا في الخلفية */
        .dina-bg {
            position: absolute;
            bottom: 0;
            left: 5%;
            height: 65vh;
            width: auto;
            z-index: 0;
            opacity: 0.8;
            filter: drop-shadow(0 0 15px rgba(255,255,255,0.5));
            transition: transform 0.3s;
        }

        /* حاوية البالونات */
        #balloons { position: absolute; top: 0; left: 0; width: 100%; height: 100%; z-index: 0; pointer-events: none; }
        .balloon {
            position: absolute;
            bottom: -100px;
            border-radius: 50%;
            opacity: 0.7;
            animation: fly 15s linear infinite;
        }
        @keyframes fly { 
            0% { transform: translateY(0) rotate(0deg); } 
            100% { transform: translateY(-120vh) rotate(20deg); } 
        }

        /* --- 2. الشاشات (الصفحات) --- */
        .screen {
            position: absolute;
            width: 100%; height: 100%;
            display: none; /* مخفي افتراضياً */
            flex-direction: column;
            align-items: center;
            justify-content: center;
            z-index: 10;
        }
        .active { display: flex; animation: fadeIn 0.5s; }
        @keyframes fadeIn { from { opacity: 0; transform: scale(0.95); } to { opacity: 1; transform: scale(1); } }

        /* --- شاشة الترحيب (لحل مشكلة الصوت في التلفزيون) --- */
        .welcome-box {
            background: rgba(255, 255, 255, 0.9);
            padding: 40px;
            border-radius: 40px;
            text-align: center;
            box-shadow: 0 20px 50px rgba(0,0,0,0.3);
            border: 8px solid #FFEB3B;
        }
        .start-btn {
            background: linear-gradient(to bottom, #FF4081, #C51162);
            color: white;
            font-size: 2.5em;
            padding: 15px 60px;
            border: 4px solid white;
            border-radius: 50px;
            cursor: pointer;
            font-family: 'Cairo', sans-serif;
            font-weight: bold;
            box-shadow: 0 10px 20px rgba(0,0,0,0.3);
            transition: transform 0.2s;
        }
        .start-btn:focus, .start-btn:hover { transform: scale(1.1); background: #FF80AB; outline: 4px solid #FFEB3B; }

        /* --- شاشة القائمة (السور) --- */
        .grid-container {
            display: grid;
            grid-template-columns: repeat(5, 1fr);
            gap: 20px;
            width: 90%;
            height: 70vh;
            overflow-y: auto;
            padding: 20px;
            scrollbar-width: none;
        }
        .grid-container::-webkit-scrollbar { display: none; }

        .surah-card {
            background: rgba(255, 255, 255, 0.85);
            border-radius: 20px;
            height: 100px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.8em;
            font-weight: 900;
            color: #3F51B5;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
            transition: all 0.2s;
            position: relative;
            border: 3px solid transparent;
        }
        
        /* التركيز بالريموت (مهم جداً) */
        .surah-card:focus {
            transform: scale(1.15);
            background: #fff;
            border-color: #FF4081;
            box-shadow: 0 0 30px #FF4081;
            z-index: 20;
        }

        .surah-num-badge {
            position: absolute;
            top: 5px; right: 5px;
            background: #FFEB3B;
            color: #333;
            font-size: 0.6em;
            width: 30px; height: 30px;
            border-radius: 50%;
            display: flex; align-items: center; justify-content: center;
            border: 2px solid white;
        }

        /* --- شاشة المشغل --- */
        .player-board {
            width: 80%;
            max-width: 700px;
            background: #FFF9C4;
            border: 10px solid #795548;
            border-radius: 30px;
            padding: 30px;
            text-align: center;
            position: relative;
            box-shadow: 0 50px 100px rgba(0,0,0,0.5);
        }

        .player-title {
            font-size: 3em;
            color: #5D4037;
            margin: 0 0 20px 0;
            text-shadow: 2px 2px 0 #fff;
        }

        .quran-display {
            background: rgba(255,255,255,0.6);
            border-radius: 15px;
            padding: 20px;
            font-family: 'Amiri', serif;
            font-size: 2.2em;
            color: #333;
            line-height: 2;
            height: 250px;
            overflow-y: auto;
            margin-bottom: 20px;
        }

        .controls { display: flex; justify-content: center; gap: 30px; }
        
        .ctrl-btn {
            width: 90px; height: 90px;
            border-radius: 50%;
            font-size: 40px;
            border: 5px solid white;
            cursor: pointer;
            color: white;
            box-shadow: 0 10px 20px rgba(0,0,0,0.3);
            display: flex; align-items: center; justify-content: center;
        }
        .btn-play { background: #4CAF50; }
        .btn-back { background: #F44336; }
        
        .ctrl-btn:focus { transform: scale(1.2); box-shadow: 0 0 25px white; }

    </style>
</head>
<body>

    <img src="assets/images/girl.png" class="dina-bg" alt="دينا" onerror="this.style.display='none'">
    
    <div id="balloons"></div>
    <div class="glass-overlay"></div>

    <div id="screen-welcome" class="screen active">
        <div class="welcome-box">
            <h1 style="color: #3F51B5; margin-bottom: 20px; font-size: 3em;">مصحف دينا التعليمي</h1>
            <button class="start-btn" id="btnStart" onclick="startApp()">▶ ابدأ الآن</button>
        </div>
    </div>

    <div id="screen-list" class="screen">
        <h2 style="color: white; font-size: 2.5em; margin-bottom: 20px; text-shadow: 0 2px 5px rgba(0,0,0,0.3);">اختر السورة يا بطل</h2>
        <div class="grid-container" id="surahGrid"></div>
    </div>

    <div id="screen-player" class="screen">
        <div class="player-board">
            <div class="player-title" id="playerTitle">سورة ...</div>
            <div class="quran-display" id="quranText">...</div>
            
            <div class="controls">
                <button class="ctrl-btn btn-back" onclick="goBack()" tabindex="0">⏹</button>
                <button class="ctrl-btn btn-play" id="btnPlayPause" onclick="togglePlay()" tabindex="0">⏸</button>
            </div>
        </div>
    </div>

    <audio id="audioPlayer"></audio>

    <script>
        // --- 1. البيانات ---
        const surahs = [
            {id: 78, name: "النبأ"}, {id: 79, name: "النازعات"}, {id: 80, name: "عبس"},
            {id: 81, name: "التكوير"}, {id: 82, name: "الانفطار"}, {id: 83, name: "المطففين"},
            {id: 84, name: "الانشقاق"}, {id: 85, name: "البروج"}, {id: 86, name: "الطارق"},
            {id: 87, name: "الأعلى"}, {id: 88, name: "الغاشية"}, {id: 89, name: "الفجر"},
            {id: 90, name: "البلد"}, {id: 91, name: "الشمس"}, {id: 92, name: "الليل"},
            {id: 93, name: "الضحى"}, {id: 94, name: "الشرح"}, {id: 95, name: "التين"},
            {id: 96, name: "العلق"}, {id: 97, name: "القدر"}, {id: 98, name: "البينة"},
            {id: 99, name: "الزلزلة"}, {id: 100, name: "العاديات"}, {id: 101, name: "القارعة"},
            {id: 102, name: "التكاثر"}, {id: 103, name: "العصر"}, {id: 104, name: "الهمزة"},
            {id: 105, name: "الفيل"}, {id: 106, name: "قريش"}, {id: 107, name: "الماعون"},
            {id: 108, name: "الكوثر"}, {id: 109, name: "الكافرون"}, {id: 110, name: "النصر"},
            {id: 111, name: "المسد"}, {id: 112, name: "الإخلاص"}, {id: 113, name: "الفلق"},
            {id: 114, name: "الناس"}
        ];

        // --- 2. المتغيرات ---
        const audio = document.getElementById('audioPlayer');
        const grid = document.getElementById('surahGrid');
        const title = document.getElementById('playerTitle');
        const btnPlayPause = document.getElementById('btnPlayPause');
        const quranText = document.getElementById('quranText');

        // --- 3. تهيئة التطبيق ---
        
        // إنشاء البالونات
        const balloonColors = ['#FF4081', '#FFEB3B', '#00E5FF', '#76FF03'];
        for(let i=0; i<15; i++){
            let b = document.createElement('div');
            b.className = 'balloon';
            b.style.left = Math.random() * 90 + '%';
            b.style.background = balloonColors[Math.floor(Math.random()*4)];
            b.style.width = (30 + Math.random()*40) + 'px';
            b.style.height = (40 + Math.random()*50) + 'px';
            b.style.animationDuration = (10 + Math.random()*10) + 's';
            b.style.animationDelay = (Math.random()*5) + 's';
            document.getElementById('balloons').appendChild(b);
        }

        // --- 4. الوظائف الأساسية ---

        // هذه الدالة أهم دالة للتلفزيون (تفتح الصوت عند أول نقرة)
        function startApp() {
            showScreen('screen-list');
            buildGrid();
            // تشغيل صوت صامت لمدة ثانية لفتح "قفل الصوت" في التلفزيون
            audio.src = ""; 
            audio.load();
        }

        function buildGrid() {
            grid.innerHTML = '';
            surahs.forEach(s => {
                let card = document.createElement('div');
                card.className = 'surah-card';
                card.tabIndex = "0"; // لجعل الكرت يقبل التركيز بالريموت
                card.innerHTML = `
                    <div class="surah-num-badge">${s.id}</div>
                    ${s.name}
                `;
                // أحداث النقر والضغط
                card.onclick = () => playSurah(s.id, s.name);
                card.onkeydown = (e) => {
                    if (e.key === 'Enter') playSurah(s.id, s.name);
                };
                grid.appendChild(card);
            });
            // التركيز على أول سورة فوراً
            setTimeout(() => {
                if(grid.children[0]) grid.children[0].focus();
            }, 100);
        }

        function playSurah(id, name) {
            showScreen('screen-player');
            title.innerText = "سورة " + name;
            quranText.innerText = "بِسْمِ اللَّهِ الرَّحْمَٰنِ الرَّحِيمِ\n(جاري التحميل...)";

            // رابط الصوت المضمون
            let formattedId = id.toString().padStart(3, '0');
            audio.src = `https://server13.mp3quran.net/husr/Mz/${formattedId}.mp3`;
            
            audio.play().then(() => {
                btnPlayPause.innerText = "⏸";
                quranText.innerText = "بِسْمِ اللَّهِ الرَّحْمَٰنِ الرَّحِيمِ";
                btnPlayPause.focus(); // نقل التركيز لزر الإيقاف
            }).catch(e => {
                console.log("Error:", e);
                btnPlayPause.innerText = "▶";
                quranText.innerText = "اضغط زر التشغيل للبدء";
            });
        }

        function togglePlay() {
            if (audio.paused) {
                audio.play();
                btnPlayPause.innerText = "⏸";
            } else {
                audio.pause();
                btnPlayPause.innerText = "▶";
            }
        }

        function goBack() {
            audio.pause();
            audio.currentTime = 0;
            showScreen('screen-list');
            // إعادة التركيز للقائمة
            if(grid.children[0]) grid.children[0].focus();
        }

        function showScreen(screenId) {
            document.querySelectorAll('.screen').forEach(s => s.classList.remove('active'));
            document.getElementById(screenId).classList.add('active');
        }

        // عند انتهاء السورة
        audio.onended = () => {
            btnPlayPause.innerText = "▶";
            quranText.innerText = "✅ صدق الله العظيم";
            setTimeout(goBack, 2000); // رجوع تلقائي
        };

        // دعم الرجوع بزر الريموت (Back)
        document.addEventListener('keydown', (e) => {
            if (e.key === 'Backspace' || e.key === 'Escape') {
                if (document.getElementById('screen-player').classList.contains('active')) {
                    goBack();
                }
            }
        });

        // التركيز المبدئي عند فتح الصفحة
        window.onload = () => {
            document.getElementById('btnStart').focus();
        };

    </script>
</body>
</html>
