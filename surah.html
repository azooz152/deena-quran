<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>ÿ™ŸÑÿßŸàÿ© ÿØŸäŸÜÿß</title>
    <link href="https://fonts.googleapis.com/css2?family=Amiri:wght@700&family=Cairo:wght@700;900&family=Lemonada:wght@500&display=swap" rel="stylesheet">
    <style>
        /* --- ŸÜŸÅÿ≥ ÿßŸÑÿ™ÿµŸÖŸäŸÖ ÿßŸÑÿßÿ≠ÿ™ÿ±ÿßŸÅŸä ÿßŸÑÿ≥ÿßÿ®ŸÇ --- */
        * { box-sizing: border-box; -webkit-tap-highlight-color: transparent; }
        body {
            margin: 0; padding: 0; height: 100vh; overflow: hidden;
            font-family: 'Cairo', sans-serif;
            background: radial-gradient(circle at center, #1a237e 0%, #000000 100%);
            display: flex; flex-direction: column; align-items: center;
            color: white;
        }

        #stars, #balloons-layer { position: fixed; top: 0; left: 0; width: 100%; height: 100%; pointer-events: none; z-index: 0; }
        .star { position: absolute; background: white; border-radius: 50%; opacity: 0.6; animation: twinkle var(--d) infinite; }
        @keyframes twinkle { 50% { opacity: 1; transform: scale(1.5); } }

        .balloon {
            position: absolute; bottom: -120px; width: 50px; height: 70px;
            border-radius: 50%; opacity: 0.7; z-index: 1;
            animation: floatUp var(--d) infinite linear;
            left: var(--x); background: var(--c);
            box-shadow: inset -5px -5px 15px rgba(0,0,0,0.2);
        }
        @keyframes floatUp { to { transform: translateY(-120vh) rotate(360deg); } }

        .header {
            width: 100%; padding: 10px 20px; z-index: 50;
            display: flex; justify-content: space-between;
        }
        .back-btn {
            background: rgba(255, 255, 255, 0.15); width: 60px; height: 60px;
            border-radius: 50%; display: flex; align-items: center; justify-content: center;
            text-decoration: none; font-size: 2rem; color: white;
            border: 3px solid rgba(255,255,255,0.3); transition: 0.3s;
            cursor: pointer; outline: none;
        }
        .back-btn:focus, .back-btn:hover {
            transform: scale(1.2); border-color: #FFD700; background: #d32f2f;
            box-shadow: 0 0 30px #d32f2f;
        }

        .quran-card {
            background: linear-gradient(to bottom, #fff9c4, #fff176);
            width: 95%; max-width: 900px; height: 65%;
            margin-top: 5px; border-radius: 40px; border: 8px solid #fff;
            box-shadow: 0 0 50px rgba(255, 215, 0, 0.25);
            display: flex; flex-direction: column; align-items: center;
            position: relative; overflow: hidden; z-index: 10;
            pointer-events: none;
        }

        .surah-title-badge {
            background: linear-gradient(135deg, #ff8f00, #ffca28);
            padding: 5px 50px; border-radius: 0 0 30px 30px;
            color: white; font-weight: 900; font-size: 1.5rem;
            font-family: 'Lemonada', sans-serif;
            box-shadow: 0 5px 15px rgba(0,0,0,0.2); margin-bottom: 10px; z-index: 10;
        }

        .quran-text-container {
            font-family: 'Amiri', serif; color: #3e2723;
            font-size: 2rem; line-height: 2.2; text-align: center;
            padding: 10px 30px 60px 30px; overflow-y: auto; width: 100%; flex-grow: 1;
            scroll-behavior: smooth; scrollbar-width: none;
        }
        .quran-text-container::-webkit-scrollbar { display: none; }
        .basmalah { display: block; margin-bottom: 20px; font-size: 1.6rem; opacity: 0.8; }

        .verse { display: inline-block; padding: 5px 10px; border-radius: 15px; margin: 4px; transition: all 0.4s; }
        .verse-active {
            color: #d84315; font-weight: 900; font-size: 2.2rem;
            background: rgba(255, 235, 59, 0.4); transform: scale(1.08);
            text-shadow: 0 0 10px rgba(255, 87, 34, 0.5);
        }

        .bottom-area {
            flex-grow: 1; width: 100%; position: relative;
            display: flex; flex-direction: column; justify-content: flex-end; align-items: center;
            padding-bottom: 20px; z-index: 20;
        }

        .dina-char {
            width: 180px; position: absolute; bottom: 10px; left: 5%;
            filter: drop-shadow(0 0 20px rgba(255,255,255,0.3));
            transition: transform 0.3s; pointer-events: none; z-index: 15;
        }
        .talking { animation: bounceChar 0.5s infinite alternate; }
        @keyframes bounceChar { to { transform: translateY(-15px) scale(1.05); } }

        .controls {
            display: flex; gap: 30px; align-items: center;
            background: rgba(20, 30, 48, 0.9); padding: 15px 40px;
            border-radius: 60px; backdrop-filter: blur(20px);
            border: 4px solid rgba(255, 255, 255, 0.2);
            box-shadow: 0 20px 50px rgba(0,0,0,0.6);
            margin-bottom: 20px; margin-left: 80px; z-index: 50;
        }

        .btn {
            width: 70px; height: 70px; border-radius: 50%; border: none;
            font-size: 2rem; color: white; cursor: pointer;
            display: flex; align-items: center; justify-content: center;
            transition: all 0.2s; outline: none; position: relative;
        }

        .nav-btn, .repeat-btn { background: rgba(255,255,255,0.1); border: 2px solid rgba(255,255,255,0.2); }
        .play-btn { 
            width: 90px; height: 90px; font-size: 3.5rem;
            background: linear-gradient(135deg, #ffc107, #ff6f00);
            box-shadow: 0 10px 20px rgba(255, 111, 0, 0.4);
        }

        .btn:focus, .btn:hover {
            transform: scale(1.3); border-color: #fff;
            box-shadow: 0 0 40px #ffea00, 0 0 10px #fff; z-index: 100;
            animation: pulseFocus 1s infinite;
        }
        .play-btn:focus, .play-btn:hover {
            background: linear-gradient(135deg, #ffd54f, #ff8f00);
            box-shadow: 0 0 60px #ff6f00, 0 0 20px #fff;
        }
        @keyframes pulseFocus { 0% { box-shadow: 0 0 30px #ffea00; } 50% { box-shadow: 0 0 60px #ffea00; } 100% { box-shadow: 0 0 30px #ffea00; } }
        .repeat-active { background: #00e676 !important; color: #004d40; border-color: white; }
    </style>
</head>
<body>

    <div id="stars"></div>
    <div id="balloons-layer"></div>

    <div class="header">
        <button class="back-btn" onclick="goBack()" tabindex="1">üîô</button>
    </div>

    <div class="quran-card" tabindex="-1">
        <div class="surah-title-badge" id="titleDisplay">ÿ≥Ÿàÿ±ÿ© ...</div>
        <div class="quran-text-container" id="textContainer"></div>
    </div>

    <div class="bottom-area">
        <img src="assets/images/girl.png" class="dina-char" id="dinaImg" alt="ÿØŸäŸÜÿß">
        <div class="controls">
            <button class="btn repeat-btn" id="loopBtn" onclick="toggleLoop()" tabindex="4">üîÅ</button>
            <button class="btn nav-btn" onclick="seek(-5)" tabindex="3">‚è™</button>
            <button class="btn play-btn" id="playBtn" onclick="togglePlay()" tabindex="2">‚ñ∂</button>
            <button class="btn nav-btn" onclick="seek(5)" tabindex="5">‚è©</button>
        </div>
    </div>

    <audio id="audioPlayer"></audio>

    <script>
        // --- ÿ™ÿ≠ÿØŸäÿ´ ŸÇÿßÿπÿØÿ© ÿßŸÑÿ®ŸäÿßŸÜÿßÿ™ ÿ®ÿßŸÑÿ≥Ÿàÿ± ÿßŸÑÿ¨ÿØŸäÿØÿ© ---
        const quranData = {
            101: { name: "ÿßŸÑŸÇÿßÿ±ÿπÿ©", verses: ["Ÿ±ŸÑ€°ŸÇŸéÿßÿ±ŸêÿπŸéÿ©Ÿè (1)", "ŸÖŸéÿß Ÿ±ŸÑ€°ŸÇŸéÿßÿ±ŸêÿπŸéÿ©Ÿè (2)", "ŸàŸéŸÖŸéÿ¢ ÿ£ŸéÿØ€°ÿ±ŸéŸâŸ∞ŸÉŸé ŸÖŸéÿß Ÿ±ŸÑ€°ŸÇŸéÿßÿ±ŸêÿπŸéÿ©Ÿè (3)", "ŸäŸéŸà€°ŸÖŸé ŸäŸéŸÉŸèŸàŸÜŸè Ÿ±ŸÑŸÜŸéŸëÿßÿ≥Ÿè ŸÉŸéŸ±ŸÑ€°ŸÅŸéÿ±Ÿéÿßÿ¥Ÿê Ÿ±ŸÑ€°ŸÖŸéÿ®€°ÿ´ŸèŸàÿ´Ÿê (4)", "ŸàŸéÿ™ŸéŸÉŸèŸàŸÜŸè Ÿ±ŸÑ€°ÿ¨Ÿêÿ®ŸéÿßŸÑŸè ŸÉŸéŸ±ŸÑ€°ÿπŸêŸá€°ŸÜŸê Ÿ±ŸÑ€°ŸÖŸéŸÜŸÅŸèŸàÿ¥Ÿê (5)", "ŸÅŸéÿ£ŸéŸÖŸéŸëÿß ŸÖŸéŸÜ ÿ´ŸéŸÇŸèŸÑŸéÿ™€° ŸÖŸéŸàŸéŸ∞ÿ≤ŸêŸäŸÜŸèŸáŸè€• (6)", "ŸÅŸéŸáŸèŸàŸé ŸÅŸêŸä ÿπŸêŸäÿ¥Ÿéÿ©Ÿñ ÿ±ŸéŸëÿßÿ∂ŸêŸäŸéÿ©Ÿñ (7)", "ŸàŸéÿ£ŸéŸÖŸéŸëÿß ŸÖŸéŸÜ€° ÿÆŸéŸÅŸéŸëÿ™€° ŸÖŸéŸàŸéŸ∞ÿ≤ŸêŸäŸÜŸèŸáŸè€• (8)", "ŸÅŸéÿ£ŸèŸÖŸèŸëŸáŸè€• ŸáŸéÿßŸàŸêŸäŸéÿ©Ÿû (9)", "ŸàŸéŸÖŸéÿ¢ ÿ£ŸéÿØ€°ÿ±ŸéŸâŸ∞ŸÉŸé ŸÖŸéÿß ŸáŸêŸäŸéŸá€° (10)", "ŸÜŸéÿßÿ±Ÿå ÿ≠ŸéÿßŸÖŸêŸäŸéÿ©Ÿè€¢ (11)"] },
            102: { name: "ÿßŸÑÿ™ŸÉÿßÿ´ÿ±", verses: ["ÿ£ŸéŸÑ€°ŸáŸéŸâŸ∞ŸÉŸèŸÖŸè Ÿ±ŸÑÿ™ŸéŸëŸÉŸéÿßÿ´Ÿèÿ±Ÿè (1)", "ÿ≠Ÿéÿ™ŸéŸëŸâŸ∞ ÿ≤Ÿèÿ±€°ÿ™ŸèŸÖŸè Ÿ±ŸÑ€°ŸÖŸéŸÇŸéÿßÿ®Ÿêÿ±Ÿé (2)", "ŸÉŸéŸÑŸéŸëÿß ÿ≥ŸéŸà€°ŸÅŸé ÿ™Ÿéÿπ€°ŸÑŸéŸÖŸèŸàŸÜŸé (3)", "ÿ´ŸèŸÖŸéŸë ŸÉŸéŸÑŸéŸëÿß ÿ≥ŸéŸà€°ŸÅŸé ÿ™Ÿéÿπ€°ŸÑŸéŸÖŸèŸàŸÜŸé (4)", "ŸÉŸéŸÑŸéŸëÿß ŸÑŸéŸà€° ÿ™Ÿéÿπ€°ŸÑŸéŸÖŸèŸàŸÜŸé ÿπŸêŸÑ€°ŸÖŸé Ÿ±ŸÑ€°ŸäŸéŸÇŸêŸäŸÜŸê (5)", "ŸÑŸéÿ™Ÿéÿ±ŸéŸàŸèŸÜŸéŸë Ÿ±ŸÑ€°ÿ¨Ÿéÿ≠ŸêŸäŸÖŸé (6)", "ÿ´ŸèŸÖŸéŸë ŸÑŸéÿ™Ÿéÿ±ŸéŸàŸèŸÜŸéŸëŸáŸéÿß ÿπŸéŸä€°ŸÜŸé Ÿ±ŸÑ€°ŸäŸéŸÇŸêŸäŸÜŸê (7)", "ÿ´ŸèŸÖŸéŸë ŸÑŸéÿ™Ÿèÿ≥€°ŸÄŸéŸîŸÑŸèŸÜŸéŸë ŸäŸéŸà€°ŸÖŸéÿ¶Ÿêÿ∞Ÿç ÿπŸéŸÜŸê Ÿ±ŸÑŸÜŸéŸëÿπŸêŸäŸÖŸê (8)"] },
            103: { name: "ÿßŸÑÿπÿµÿ±", verses: ["ŸàŸéŸ±ŸÑ€°ÿπŸéÿµ€°ÿ±Ÿê (1)", "ÿ•ŸêŸÜŸéŸë Ÿ±ŸÑ€°ÿ•ŸêŸÜÿ≥ŸéŸ∞ŸÜŸé ŸÑŸéŸÅŸêŸä ÿÆŸèÿ≥€°ÿ±Ÿç (2)", "ÿ•ŸêŸÑŸéŸëÿß Ÿ±ŸÑŸéŸëÿ∞ŸêŸäŸÜŸé ÿ°ŸéÿßŸÖŸéŸÜŸèŸàÿßŸí ŸàŸéÿπŸéŸÖŸêŸÑŸèŸàÿßŸí Ÿ±ŸÑÿµŸéŸëŸÄŸ∞ŸÑŸêÿ≠ŸéŸ∞ÿ™Ÿê ŸàŸéÿ™ŸéŸàŸéÿßÿµŸéŸà€°ÿßŸí ÿ®ŸêŸ±ŸÑ€°ÿ≠ŸéŸÇŸêŸë ŸàŸéÿ™ŸéŸàŸéÿßÿµŸéŸà€°ÿßŸí ÿ®ŸêŸ±ŸÑÿµŸéŸëÿ®€°ÿ±Ÿê (3)"] },
            104: { name: "ÿßŸÑŸáŸÖÿ≤ÿ©", verses: ["ŸàŸéŸä€°ŸÑŸû ŸÑŸêŸëŸÉŸèŸÑŸêŸë ŸáŸèŸÖŸéÿ≤Ÿéÿ©Ÿñ ŸÑŸèŸëŸÖŸéÿ≤Ÿéÿ©Ÿç (1)", "Ÿ±ŸÑŸéŸëÿ∞ŸêŸä ÿ¨ŸéŸÖŸéÿπŸé ŸÖŸéÿßŸÑŸóÿß ŸàŸéÿπŸéÿØŸéŸëÿØŸéŸáŸè€• (2)", "ŸäŸéÿ≠€°ÿ≥Ÿéÿ®Ÿè ÿ£ŸéŸÜŸéŸë ŸÖŸéÿßŸÑŸéŸáŸè€•Ÿì ÿ£ŸéÿÆ€°ŸÑŸéÿØŸéŸáŸè€• (3)", "ŸÉŸéŸÑŸéŸëÿß€ñ ŸÑŸéŸäŸèŸÜ€¢ÿ®Ÿéÿ∞ŸéŸÜŸéŸë ŸÅŸêŸä Ÿ±ŸÑ€°ÿ≠Ÿèÿ∑ŸéŸÖŸéÿ©Ÿê (4)", "ŸàŸéŸÖŸéÿ¢ ÿ£ŸéÿØ€°ÿ±ŸéŸâŸ∞ŸÉŸé ŸÖŸéÿß Ÿ±ŸÑ€°ÿ≠Ÿèÿ∑ŸéŸÖŸéÿ©Ÿè (5)", "ŸÜŸéÿßÿ±Ÿè Ÿ±ŸÑŸÑŸéŸëŸáŸê Ÿ±ŸÑ€°ŸÖŸèŸàŸÇŸéÿØŸéÿ©Ÿè (6)", "Ÿ±ŸÑŸéŸëÿ™ŸêŸä ÿ™Ÿéÿ∑ŸéŸëŸÑŸêÿπŸè ÿπŸéŸÑŸéŸâ Ÿ±ŸÑ€°ÿ£ŸéŸÅ€°ŸÄŸêŸîÿØŸéÿ©Ÿê (7)", "ÿ•ŸêŸÜŸéŸëŸáŸéÿß ÿπŸéŸÑŸéŸä€°ŸáŸêŸÖ ŸÖŸèŸëÿ§€°ÿµŸéÿØŸéÿ©Ÿû (8)", "ŸÅŸêŸä ÿπŸéŸÖŸéÿØŸñ ŸÖŸèŸëŸÖŸéÿØŸéŸëÿØŸéÿ©Ÿê€¢ (9)"] },
            // --- ÿßŸÑÿ≥Ÿàÿ± ÿßŸÑÿ¨ÿØŸäÿØÿ© ÿßŸÑÿ™Ÿä ÿ£ÿ∂ŸÅÿ™Ÿáÿß ÿßŸÑÿ¢ŸÜ ---
            107: { name: "ÿßŸÑŸÖÿßÿπŸàŸÜ", verses: ["ÿ£Ÿéÿ±Ÿéÿ°ŸéŸä€°ÿ™Ÿé Ÿ±ŸÑŸéŸëÿ∞ŸêŸä ŸäŸèŸÉŸéÿ∞ŸêŸëÿ®Ÿè ÿ®ŸêŸ±ŸÑÿØŸêŸëŸäŸÜŸê (1)", "ŸÅŸéÿ∞ŸéŸ∞ŸÑŸêŸÉŸé Ÿ±ŸÑŸéŸëÿ∞ŸêŸä ŸäŸéÿØŸèÿπŸèŸë Ÿ±ŸÑ€°ŸäŸéÿ™ŸêŸäŸÖŸé (2)", "ŸàŸéŸÑŸéÿß ŸäŸéÿ≠Ÿèÿ∂ŸèŸë ÿπŸéŸÑŸéŸâŸ∞ ÿ∑ŸéÿπŸéÿßŸÖŸê Ÿ±ŸÑ€°ŸÖŸêÿ≥€°ŸÉŸêŸäŸÜŸê (3)", "ŸÅŸéŸàŸéŸä€°ŸÑŸû ŸÑŸêŸëŸÑ€°ŸÖŸèÿµŸéŸÑŸêŸëŸäŸÜŸé (4)", "Ÿ±ŸÑŸéŸëÿ∞ŸêŸäŸÜŸé ŸáŸèŸÖ€° ÿπŸéŸÜ ÿµŸéŸÑŸéÿßÿ™ŸêŸáŸêŸÖ€° ÿ≥ŸéÿßŸáŸèŸàŸÜŸé (5)", "Ÿ±ŸÑŸéŸëÿ∞ŸêŸäŸÜŸé ŸáŸèŸÖ€° ŸäŸèÿ±Ÿéÿ¢ÿ°ŸèŸàŸÜŸé (6)", "ŸàŸéŸäŸéŸÖ€°ŸÜŸéÿπŸèŸàŸÜŸé Ÿ±ŸÑ€°ŸÖŸéÿßÿπŸèŸàŸÜŸé (7)"] },
            109: { name: "ÿßŸÑŸÉÿßŸÅÿ±ŸàŸÜ", verses: ["ŸÇŸèŸÑ€° ŸäŸéŸÄŸ∞Ÿìÿ£ŸéŸäŸèŸëŸáŸéÿß Ÿ±ŸÑ€°ŸÉŸéŸ∞ŸÅŸêÿ±ŸèŸàŸÜŸé (1)", "ŸÑŸéÿ¢ ÿ£Ÿéÿπ€°ÿ®ŸèÿØŸè ŸÖŸéÿß ÿ™Ÿéÿπ€°ÿ®ŸèÿØŸèŸàŸÜŸé (2)", "ŸàŸéŸÑŸéÿ¢ ÿ£ŸéŸÜÿ™ŸèŸÖ€° ÿπŸéŸ∞ÿ®ŸêÿØŸèŸàŸÜŸé ŸÖŸéÿ¢ ÿ£Ÿéÿπ€°ÿ®ŸèÿØŸè (3)", "ŸàŸéŸÑŸéÿ¢ ÿ£ŸéŸÜŸéÿß€† ÿπŸéÿßÿ®ŸêÿØŸû ŸÖŸéŸëÿß ÿπŸéÿ®ŸéÿØÿ™ŸèŸëŸÖ€° (4)", "ŸàŸéŸÑŸéÿ¢ ÿ£ŸéŸÜÿ™ŸèŸÖ€° ÿπŸéŸ∞ÿ®ŸêÿØŸèŸàŸÜŸé ŸÖŸéÿ¢ ÿ£Ÿéÿπ€°ÿ®ŸèÿØŸè (5)", "ŸÑŸéŸÉŸèŸÖ€° ÿØŸêŸäŸÜŸèŸÉŸèŸÖ€° ŸàŸéŸÑŸêŸäŸé ÿØŸêŸäŸÜŸê (6)"] },
            111: { name: "ÿßŸÑŸÖÿ≥ÿØ", verses: ["ÿ™Ÿéÿ®ŸéŸëÿ™€° ŸäŸéÿØŸéÿ¢ ÿ£Ÿéÿ®ŸêŸä ŸÑŸéŸáŸéÿ®Ÿñ ŸàŸéÿ™Ÿéÿ®ŸéŸë (1)", "ŸÖŸéÿ¢ ÿ£Ÿéÿ∫€°ŸÜŸéŸâŸ∞ ÿπŸéŸÜ€°ŸáŸè ŸÖŸéÿßŸÑŸèŸáŸè€• ŸàŸéŸÖŸéÿß ŸÉŸéÿ≥Ÿéÿ®Ÿé (2)", "ÿ≥ŸéŸäŸéÿµ€°ŸÑŸéŸâŸ∞ ŸÜŸéÿßÿ±Ÿóÿß ÿ∞Ÿéÿßÿ™Ÿé ŸÑŸéŸáŸéÿ®Ÿñ (3)", "ŸàŸéŸ±ŸÖ€°ÿ±Ÿéÿ£Ÿéÿ™ŸèŸáŸè€• ÿ≠ŸéŸÖŸéŸëÿßŸÑŸéÿ©Ÿé Ÿ±ŸÑ€°ÿ≠Ÿéÿ∑Ÿéÿ®Ÿê (4)", "ŸÅŸêŸä ÿ¨ŸêŸäÿØŸêŸáŸéÿß ÿ≠Ÿéÿ®€°ŸÑŸû ŸÖŸêŸëŸÜ ŸÖŸéŸëÿ≥ŸéÿØŸê€¢ (5)"] }
        };

        const audio = document.getElementById('audioPlayer');
        const playBtn = document.getElementById('playBtn');
        const textContainer = document.getElementById('textContainer');
        let currentVersesElements = [];

        window.onload = () => {
            createBalloons();
            createStars();
            const urlParams = new URLSearchParams(window.location.search);
            const id = urlParams.get('id');
            if (quranData[id]) {
                document.getElementById('titleDisplay').innerText = "ÿ≥Ÿàÿ±ÿ© " + quranData[id].name;
                audio.src = `${id}.mp3`;
                let html = '<span class="basmalah">ÿ®Ÿêÿ≥€°ŸÖŸê Ÿ±ŸÑŸÑŸéŸëŸáŸê Ÿ±ŸÑÿ±ŸéŸëÿ≠€°ŸÖŸéŸ∞ŸÜŸê Ÿ±ŸÑÿ±ŸéŸëÿ≠ŸêŸäŸÖŸê</span>';
                quranData[id].verses.forEach((v, i) => html += `<span class="verse">${v} </span>`);
                textContainer.innerHTML = html;
                currentVersesElements = Array.from(textContainer.getElementsByClassName('verse'));
            } else {
                textContainer.innerHTML = "<p>ŸÇÿ±Ÿäÿ®ÿßŸã...</p>";
            }
            playBtn.focus();
        };

        // --- ŸÜÿ∏ÿßŸÖ ÿ•ŸäŸÇÿßŸÅ ÿßŸÑÿµŸàÿ™ ÿßŸÑÿ≠ÿßÿ≤ŸÖ ---
        function killAudio() {
            audio.pause();
            audio.currentTime = 0;
            audio.src = ""; // ÿ™ŸÅÿ±Ÿäÿ∫ ÿßŸÑŸÖÿµÿØÿ±
        }

        function goBack() {
            killAudio();
            window.location.href = 'surah_list.html';
        }

        window.addEventListener('beforeunload', killAudio);
        document.addEventListener('visibilitychange', () => {
            if (document.hidden) {
                killAudio();
                playBtn.innerText = "‚ñ∂";
            }
        });

        // --- ÿßŸÑÿ™ÿ≠ŸÉŸÖ ---
        function togglePlay() {
            if (audio.paused) {
                if(!audio.src) {
                    const id = new URLSearchParams(window.location.search).get('id');
                    audio.src = `${id}.mp3`;
                }
                audio.play();
                playBtn.innerText = "‚è∏";
                document.getElementById('dinaImg').classList.add('talking');
            } else {
                audio.pause();
                playBtn.innerText = "‚ñ∂";
                document.getElementById('dinaImg').classList.remove('talking');
            }
        }

        function toggleLoop() {
            audio.loop = !audio.loop;
            document.getElementById('loopBtn').classList.toggle('repeat-active', audio.loop);
        }

        function seek(sec) { audio.currentTime += sec; }

        audio.ontimeupdate = () => {
            if (!audio.duration || currentVersesElements.length === 0) return;
            const progress = audio.currentTime / audio.duration;
            let idx = Math.floor(progress * currentVersesElements.length);
            idx = Math.min(idx, currentVersesElements.length - 1);
            currentVersesElements.forEach(el => el.classList.remove('verse-active'));
            if (currentVersesElements[idx]) {
                const el = currentVersesElements[idx];
                el.classList.add('verse-active');
                el.scrollIntoView({ behavior: 'smooth', block: 'center' });
            }
        };

        audio.onended = () => {
            if(!audio.loop) {
                playBtn.innerText = "‚ñ∂";
                document.getElementById('dinaImg').classList.remove('talking');
                currentVersesElements.forEach(el => el.classList.remove('verse-active'));
                textContainer.scrollTo({ top: 0, behavior: 'smooth' });
                playBtn.focus();
            }
        };

        function createBalloons() {
            const c = document.getElementById('balloons-layer');
            const colors = ['#e91e63', '#00bcd4', '#ffeb3b', '#8bc34a'];
            for(let i=0; i<12; i++){
                const b = document.createElement('div');
                b.className = 'balloon';
                b.style.setProperty('--x', Math.random()*95+'vw');
                b.style.setProperty('--d', (Math.random()*10+10)+'s');
                b.style.setProperty('--c', colors[Math.floor(Math.random()*colors.length)]);
                b.style.animationDelay = (Math.random()*5)+'s';
                c.appendChild(b);
            }
        }
        function createStars() {
            const s = document.getElementById('stars');
            for(let i=0; i<50; i++){
                const d = document.createElement('div');
                d.className = 'star';
                d.style.left=Math.random()*100+'%'; d.style.top=Math.random()*100+'%';
                d.style.width=Math.random()*3+'px'; d.style.height=d.style.width;
                d.style.setProperty('--d', (Math.random()*2+1)+'s');
                s.appendChild(d);
            }
        }
    </script>
</body>
</html>
