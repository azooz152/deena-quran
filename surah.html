<!DOCTYPE html>
<html lang="ar">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ù…Ø´ØºÙ„ Ø§Ù„Ù‚Ø±Ø¢Ù†</title>
    <link rel="stylesheet" href="style.css">
    <style>
        body {
            background: url('https://azooz152.github.io/deena-quran/assets/bg-main.png') center/cover fixed; 
            height: 100vh;
            overflow: hidden;
            display: flex;
            align-items: center;
            justify-content: center;
            font-family: 'Tahoma', sans-serif;
        }

        /* Ø§Ù„Ø­Ø§ÙˆÙŠØ© Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ© */
        .player-glass {
            width: 90%;
            height: 90vh;
            background: rgba(255, 255, 255, 0.85);
            border-radius: 40px;
            border: 8px solid #ff4081; /* Ø¥Ø·Ø§Ø± ÙˆØ±Ø¯ÙŠ */
            display: flex;
            flex-direction: row; /* ØªØ±ØªÙŠØ¨ Ø£ÙÙ‚ÙŠ: Ø´Ø®ØµÙŠØ© ÙŠÙ…ÙŠÙ†ØŒ Ù†Øµ ÙŠØ³Ø§Ø± */
            overflow: hidden;
            box-shadow: 0 0 50px rgba(0,0,0,0.5);
        }

        /* Ø§Ù„Ù‚Ø³Ù… Ø§Ù„Ø£ÙŠÙ…Ù†: Ø§Ù„Ø´Ø®ØµÙŠØ© */
        .character-section {
            width: 35%;
            background: #fff9c4; /* Ø£ØµÙØ± ÙØ§ØªØ­ */
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            border-left: 5px solid #ff4081;
            position: relative;
        }

        /* ØµÙˆØ±Ø© Ø§Ù„Ø´Ø®ØµÙŠØ© */
        .cartoon-char {
            width: 80%;
            max-width: 300px;
            position: relative;
        }
        .cartoon-char img {
            width: 100%;
            border-radius: 20px;
        }
        
        /* Ø­Ø±ÙƒØ© Ø§Ù„ÙÙ… */
        .mouth-anim {
            position: absolute;
            top: 55%; 
            left: 50%;
            transform: translate(-50%, -50%);
            width: 40px;
            height: 10px;
            background: #a93226;
            border-radius: 50%;
            transition: all 0.1s;
        }
        /* ÙƒÙ„Ø§Ø³ ÙŠØ¶Ø§Ù Ø¨Ø§Ù„Ø¬Ø§ÙØ§Ø³ÙƒØ±Ø¨Øª Ø¹Ù†Ø¯ Ø§Ù„ØªØ´ØºÙŠÙ„ */
        .talking {
            animation: talk 0.3s infinite alternate;
        }
        @keyframes talk {
            0% { height: 5px; width: 35px; }
            100% { height: 25px; width: 40px; border: 2px solid white; }
        }

        /* Ø§Ù„Ù‚Ø³Ù… Ø§Ù„Ø£ÙŠØ³Ø±: Ø§Ù„Ù†Øµ ÙˆØ§Ù„ØªØ­ÙƒÙ… */
        .content-section {
            width: 65%;
            padding: 20px;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: space-between;
        }

        /* Ø¹Ù†ÙˆØ§Ù† Ø§Ù„Ø³ÙˆØ±Ø© */
        .surah-title {
            background: #6a11cb;
            color: #fff;
            padding: 10px 40px;
            border-radius: 30px;
            font-size: 28px;
            margin-bottom: 10px;
            box-shadow: 0 4px 10px rgba(0,0,0,0.3);
        }

        /* Ù…Ø±Ø¨Ø¹ Ø§Ù„Ù†Øµ Ø§Ù„Ù‚Ø±Ø¢Ù†ÙŠ */
        .quran-text-box {
            background: rgba(255,255,255,0.6);
            width: 100%;
            flex-grow: 1;
            border-radius: 20px;
            border: 3px solid #ff4081;
            padding: 20px;
            font-size: 28px;
            line-height: 1.8;
            color: #2c3e50;
            overflow-y: auto;
            text-align: center;
            font-family: 'Amiri', serif; /* Ø®Ø· Ù‚Ø±Ø¢Ù†ÙŠ */
            box-shadow: inset 0 0 20px rgba(0,0,0,0.1);
        }

        /* Ù…Ù†Ø·Ù‚Ø© Ø§Ù„Ø£Ø²Ø±Ø§Ø± */
        .controls {
            display: flex;
            gap: 30px;
            margin-top: 20px;
            align-items: center;
        }

        .btn-control {
            width: 80px;
            height: 80px;
            border-radius: 50%;
            border: none;
            font-size: 30px;
            cursor: pointer;
            box-shadow: 0 5px 15px rgba(0,0,0,0.3);
            display: flex;
            align-items: center;
            justify-content: center;
            transition: transform 0.2s;
        }
        .btn-play { background: #4caf50; color: white; }
        .btn-pause { background: #f44336; color: white; }
        .btn-back { background: #2196f3; color: white; }

        .btn-control:focus {
            transform: scale(1.2);
            border: 4px solid #fff;
            outline: none;
        }

        /* Ø¥Ø®ÙØ§Ø¡ Ø§Ù„Ù…Ø´ØºÙ„ Ø§Ù„Ø­Ù‚ÙŠÙ‚ÙŠ */
        audio { display: none; }

    </style>
    <link href="https://fonts.googleapis.com/css2?family=Amiri:wght@400;700&display=swap" rel="stylesheet">
</head>
<body>

    <div class="player-glass">
        <div class="character-section">
            <div class="cartoon-char">
                <img src="https://cdn-icons-png.flaticon.com/512/4264/4264818.png" alt="Ù‚Ø§Ø±Ø¦">
                <div class="mouth-anim" id="mouth"></div>
            </div>
        </div>

        <div class="content-section">
            <div class="surah-title" id="titleDisplay">...</div>
            
            <div class="quran-text-box" id="quranText">
                Ø¬Ø§Ø±ÙŠ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø¢ÙŠØ§Øª...
            </div>

            <div class="controls">
                <button class="btn-control btn-play" id="playBtn" onclick="playAudio()">â–¶</button>
                <button class="btn-control btn-back" onclick="goBack()">ğŸ”™</button>
                <button class="btn-control btn-pause" id="pauseBtn" onclick="pauseAudio()">â¸</button>
            </div>
        </div>
    </div>

    <audio id="audioPlayer"></audio>

    <script>
        // Ø§Ø³ØªØ®Ø±Ø§Ø¬ Ø±Ù‚Ù… Ø§Ù„Ø³ÙˆØ±Ø© ÙˆØ§Ø³Ù…Ù‡Ø§ Ù…Ù† Ø§Ù„Ø±Ø§Ø¨Ø·
        const urlParams = new URLSearchParams(window.location.search);
        const surahId = urlParams.get('id');
        const surahName = urlParams.get('name');

        // Ø¹Ù†Ø§ØµØ± Ø§Ù„ØµÙØ­Ø©
        const audioPlayer = document.getElementById('audioPlayer');
        const quranText = document.getElementById('quranText');
        const titleDisplay = document.getElementById('titleDisplay');
        const mouth = document.getElementById('mouth');
        const playBtn = document.getElementById('playBtn');

        // ØªØ¹ÙŠÙŠÙ† Ø§Ù„Ø¹Ù†ÙˆØ§Ù†
        if(surahName) titleDisplay.innerText = "Ø³ÙˆØ±Ø© " + surahName;

        // Ø¯Ø§Ù„Ø© Ù„Ø¬Ù„Ø¨ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ù…Ù† Ø§Ù„Ø¥Ù†ØªØ±Ù†Øª ØªÙ„Ù‚Ø§Ø¦ÙŠØ§Ù‹
        async function loadSurahData() {
            if(!surahId) return;

            // 1. Ø±Ø§Ø¨Ø· Ø§Ù„ØµÙˆØª (Ø§Ù„Ù…Ù†Ø´Ø§ÙˆÙŠ Ø§Ù„Ù…ØµØ­Ù Ø§Ù„Ù…Ø¹Ù„Ù… - Ø¬ÙˆØ¯Ø© Ø¹Ø§Ù„ÙŠØ©)
            // Ù†Ø³ØªØ®Ø¯Ù… ØªÙ†Ø³ÙŠÙ‚ 3 Ø®Ø§Ù†Ø§Øª (Ù…Ø«Ù„Ø§Ù‹ 001, 010, 114)
            const formattedId = surahId.toString().padStart(3, '0');
            const audioUrl = `https://server10.mp3quran.net/minsh_awi/${formattedId}.mp3`;
            audioPlayer.src = audioUrl;

            // 2. Ø¬Ù„Ø¨ Ø§Ù„Ù†Øµ Ø§Ù„Ù‚Ø±Ø¢Ù†ÙŠ (API)
            try {
                const response = await fetch(`https://api.alquran.cloud/v1/surah/${surahId}`);
                const data = await response.json();
                
                let fullText = "";
                // ØªØ¬Ù…ÙŠØ¹ Ø§Ù„Ø¢ÙŠØ§Øª Ù…Ø¹ ÙˆØ¶Ø¹ ÙÙˆØ§ØµÙ„
                data.data.ayahs.forEach(ayah => {
                    fullText += ayah.text + " ï´¿" + ayah.numberInSurah + "ï´¾ ";
                });
                
                // Ø¹Ø±Ø¶ Ø§Ù„Ù†Øµ ÙˆØªÙƒØ¨ÙŠØ± Ø§Ù„Ø®Ø·
                quranText.innerHTML = `<p style="direction: rtl; text-align: justify;">${fullText}</p>`;
            } catch (error) {
                quranText.innerText = "ØªØ£ÙƒØ¯ Ù…Ù† Ø§Ù„Ø§ØªØµØ§Ù„ Ø¨Ø§Ù„Ø¥Ù†ØªØ±Ù†Øª Ù„ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù†Øµ.";
            }
        }

        // Ø¯ÙˆØ§Ù„ Ø§Ù„ØªØ­ÙƒÙ…
        function playAudio() {
            audioPlayer.play();
            mouth.classList.add('talking'); // ØªØ´ØºÙŠÙ„ Ø­Ø±ÙƒØ© Ø§Ù„Ø´ÙØ§ÙŠÙ
        }

        function pauseAudio() {
            audioPlayer.pause();
            mouth.classList.remove('talking'); // Ø¥ÙŠÙ‚Ø§Ù Ø­Ø±ÙƒØ© Ø§Ù„Ø´ÙØ§ÙŠÙ
        }

        function goBack() {
            window.location.href = 'surah_list.html';
        }

        // Ù…Ø³ØªÙ…Ø¹Ø§Øª Ø§Ù„Ø£Ø­Ø¯Ø§Ø« Ù„Ù„ØªØ²Ø§Ù…Ù†
        audioPlayer.onpause = () => mouth.classList.remove('talking');
        audioPlayer.onplay = () => mouth.classList.add('talking');
        audioPlayer.onended = () => mouth.classList.remove('talking'); // Ø¹Ù†Ø¯ Ø§Ù†ØªÙ‡Ø§Ø¡ Ø§Ù„Ø³ÙˆØ±Ø©

        // ØªØ´ØºÙŠÙ„ Ø§Ù„ØªØ±ÙƒÙŠØ² Ø§Ù„ØªÙ„Ù‚Ø§Ø¦ÙŠ Ù„Ø²Ø± Ø§Ù„ØªØ´ØºÙŠÙ„ Ø¹Ù†Ø¯ Ø§Ù„ÙØªØ­ (Ù„Ù„Ø±ÙŠÙ…ÙˆØª)
        window.onload = () => {
            loadSurahData();
            playBtn.focus();
        };

        // Ø¯Ø¹Ù… Ø§Ù„ØªÙ†Ù‚Ù„ Ø¨Ø§Ù„Ø±ÙŠÙ…ÙˆØª Ø¯Ø§Ø®Ù„ Ø§Ù„Ø£Ø²Ø±Ø§Ø±
        document.addEventListener('keydown', function(e) {
            if(e.key === 'Backspace' || e.key === 'Escape') {
                goBack();
            }
        });

    </script>
</body>
</html>
